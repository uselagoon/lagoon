- name: "{{ testname }} - POST bitbucket push webhook with target git hash {{ git_hash_push }}, branch {{ branch }} and repo {{ git_repo_ssh_url }} to {{ webhook_url }}"
  uri:
    url: "{{ webhook_url }}"
    headers:
      User-Agent: Bitbucket-Webhooks/2.0
      X-Event-Key: repo:push
      X-Hook-Uuid: bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb
      X-Request-Uuid: cccccccc-cccc-cccc-cccccccccccc
      content-type: application/json
    method: POST
    follow_redirects: yes
    body_format: json
    body: '{"push":{"changes":[{"forced":false,"old":{"type":"branch","name":"{{ branch }}","links":{"commits":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commits/develop"},"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/refs/branches/develop"},"html":{"href":"https://bitbucket.org/twardnw/amazeeio-site/branch/develop"}},"target":{"hash":"5832e7751e50bd719343033a124eaa2f5c4e8757","links":{"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commit/5832e7751e50bd719343033a124eaa2f5c4e8757"},"html":{"href":"https://bitbucket.org/twardnw/amazeeio-site/commits/5832e7751e50bd719343033a124eaa2f5c4e8757"}},"author":{"raw":"Tyler Ward <twardnw@gmail.com>","type":"author","user":{"username":"twardnw","type":"user","display_name":"Tyler Ward","uuid":"{30b80339-43dd-4f3a-93cd-a2cfc8ecaaa4}","links":{"self":{"href":"https://api.bitbucket.org/2.0/users/twardnw"},"html":{"href":"https://bitbucket.org/twardnw/"},"avatar":{"href":"https://bitbucket.org/account/twardnw/avatar/32/"}}}},"parents":[{"type":"commit","hash":"7e4814137ae5a624f4284f1b85577b6f50f21003","links":{"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commit/7e4814137ae5a624f4284f1b85577b6f50f21003"},"html":{"href":"https://bitbucket.org/twardnw/amazeeio-site/commits/7e4814137ae5a624f4284f1b85577b6f50f21003"}}}],"date":"2017-07-13T18:33:04+00:00","message":"bitbucket regular push\n","type":"commit"}},"links":{"commits":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commits?include=7ff1529b7375f1fd2f9b238f84a5769edb42d08a&exclude=5832e7751e50bd719343033a124eaa2f5c4e8757"},"html":{"href":"https://bitbucket.org/twardnw/amazeeio-site/branches/compare/7ff1529b7375f1fd2f9b238f84a5769edb42d08a..5832e7751e50bd719343033a124eaa2f5c4e8757"},"diff":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/diff/7ff1529b7375f1fd2f9b238f84a5769edb42d08a..5832e7751e50bd719343033a124eaa2f5c4e8757"}},"truncated":false,"commits":[{"hash":"{{ git_hash_push }}","links":{"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commit/7ff1529b7375f1fd2f9b238f84a5769edb42d08a"},"comments":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commit/7ff1529b7375f1fd2f9b238f84a5769edb42d08a/comments"},"patch":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/patch/7ff1529b7375f1fd2f9b238f84a5769edb42d08a"},"html":{"href":"https://bitbucket.org/twardnw/amazeeio-site/commits/7ff1529b7375f1fd2f9b238f84a5769edb42d08a"},"diff":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/diff/7ff1529b7375f1fd2f9b238f84a5769edb42d08a"},"approve":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commit/7ff1529b7375f1fd2f9b238f84a5769edb42d08a/approve"},"statuses":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commit/7ff1529b7375f1fd2f9b238f84a5769edb42d08a/statuses"}},"author":{"raw":"Tyler Ward <twardnw@gmail.com>","type":"author","user":{"username":"twardnw","type":"user","display_name":"Tyler Ward","uuid":"{30b80339-43dd-4f3a-93cd-a2cfc8ecaaa4}","links":{"self":{"href":"https://api.bitbucket.org/2.0/users/twardnw"},"html":{"href":"https://bitbucket.org/twardnw/"},"avatar":{"href":"https://bitbucket.org/account/twardnw/avatar/32/"}}}},"parents":[{"type":"commit","hash":"5832e7751e50bd719343033a124eaa2f5c4e8757","links":{"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commit/5832e7751e50bd719343033a124eaa2f5c4e8757"},"html":{"href":"https://bitbucket.org/twardnw/amazeeio-site/commits/5832e7751e50bd719343033a124eaa2f5c4e8757"}}}],"date":"2017-07-13T22:56:03+00:00","message":"another push\n","type":"commit"}],"created":false,"closed":false,"new":{"type":"branch","name":"{{ branch }}","links":{"commits":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commits/develop"},"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/refs/branches/develop"},"html":{"href":"https://bitbucket.org/twardnw/amazeeio-site/branch/develop"}},"target":{"hash":"{{ git_hash_push }}","links":{"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commit/7ff1529b7375f1fd2f9b238f84a5769edb42d08a"},"html":{"href":"https://bitbucket.org/twardnw/amazeeio-site/commits/7ff1529b7375f1fd2f9b238f84a5769edb42d08a"}},"author":{"raw":"Tyler Ward <twardnw@gmail.com>","type":"author","user":{"username":"twardnw","type":"user","display_name":"Tyler Ward","uuid":"{30b80339-43dd-4f3a-93cd-a2cfc8ecaaa4}","links":{"self":{"href":"https://api.bitbucket.org/2.0/users/twardnw"},"html":{"href":"https://bitbucket.org/twardnw/"},"avatar":{"href":"https://bitbucket.org/account/twardnw/avatar/32/"}}}},"parents":[{"type":"commit","hash":"5832e7751e50bd719343033a124eaa2f5c4e8757","links":{"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site/commit/5832e7751e50bd719343033a124eaa2f5c4e8757"},"html":{"href":"https://bitbucket.org/twardnw/amazeeio-site/commits/5832e7751e50bd719343033a124eaa2f5c4e8757"}}}],"date":"2017-07-13T22:56:03+00:00","message":"another push\n","type":"commit"}}}]},"actor":{"username":"twardnw","type":"user","display_name":"Tyler Ward","uuid":"{30b80339-43dd-4f3a-93cd-a2cfc8ecaaa4}","links":{"self":{"href":"https://api.bitbucket.org/2.0/users/twardnw"},"html":{"href":"https://bitbucket.org/twardnw/"},"avatar":{"href":"https://bitbucket.org/account/twardnw/avatar/32/"}}},"repository":{"scm":"git","website":"","name":"amazeeio-site","links":{"self":{"href":"https://api.bitbucket.org/2.0/repositories/twardnw/amazeeio-site"},"html":{"href":"{{ git_repo_url }}"},"avatar":{"href":"https://bitbucket.org/twardnw/amazeeio-site/avatar/32/"}},"full_name":"{{ git_repo_full_name }}","owner":{"username":"twardnw","type":"user","display_name":"Tyler Ward","uuid":"{30b80339-43dd-4f3a-93cd-a2cfc8ecaaa4}","links":{"self":{"href":"https://api.bitbucket.org/2.0/users/twardnw"},"html":{"href":"https://bitbucket.org/twardnw/"},"avatar":{"href":"https://bitbucket.org/account/twardnw/avatar/32/"}}},"type":"repository","is_private":true,"uuid":"{34d2ec16-e8eb-4223-a449-cdd6447db7ea}"}}'