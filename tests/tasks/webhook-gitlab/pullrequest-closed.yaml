- name: "{{ testname }} - POST gitlab pull request merged webhook with pr number {{ git_pr_number }} repo {{ git_repo_ssh_url }} to {{ webhook_url }}"
  uri:
    url: "{{ webhook_url }}"
    headers:
      X-Gitlab-Event: Merge Request Hook
      content-type: application/json
    method: POST
    follow_redirects: yes
    body_format: json
    body: '{"object_kind":"merge_request","user":{"name":"Michael Schmid","username":"michael.schmid1","avatar_url":"https://secure.gravatar.com/avatar/c4f5bd5f32eec798c2df7afe0040c49f?s=80\u0026d=identicon"},"project":{"id":5796982,"name":"test","description":"","web_url":"https://gitlab.com/michael.schmid1/test","avatar_url":null,"git_ssh_url":"{{ git_repo_ssh_url }}","git_http_url":"https://gitlab.com/michael.schmid1/test.git","namespace":"michael.schmid1","visibility_level":0,"path_with_namespace":"michael.schmid1/test","default_branch":"master","ci_config_path":null,"homepage":"https://gitlab.com/michael.schmid1/test","url":"git@gitlab.com:michael.schmid1/test.git","ssh_url":"git@gitlab.com:michael.schmid1/test.git","http_url":"https://gitlab.com/michael.schmid1/test.git"},"object_attributes":{"assignee_id":null,"author_id":2127130,"created_at":"2018-03-19 00:01:08 UTC","description":"bla bla bbla","head_pipeline_id":null,"id":123456789,"iid":{{ git_pr_number }},"last_edited_at":"2018-03-19 00:04:33 UTC","last_edited_by_id":2127130,"merge_commit_sha":null,"merge_error":null,"merge_params":{"force_remove_source_branch":"0"},"merge_status":"unchecked","merge_user_id":null,"merge_when_pipeline_succeeds":false,"milestone_id":null,"source_branch":"{{ git_pr_branch }}","source_project_id":5796982,"state":"merged","target_branch":"{{ git_base_branch }}","target_project_id":5796982,"time_estimate":0,"title":"My Merge Request edit","updated_at":"2018-03-19 00:07:53 UTC","updated_by_id":2127130,"url":"https://gitlab.com/michael.schmid1/test/merge_requests/1","source":{"id":5796982,"name":"test","description":"","web_url":"https://gitlab.com/michael.schmid1/test","avatar_url":null,"git_ssh_url":"git@gitlab.com:michael.schmid1/test.git","git_http_url":"https://gitlab.com/michael.schmid1/test.git","namespace":"michael.schmid1","visibility_level":0,"path_with_namespace":"michael.schmid1/test","default_branch":"master","ci_config_path":null,"homepage":"https://gitlab.com/michael.schmid1/test","url":"git@gitlab.com:michael.schmid1/test.git","ssh_url":"git@gitlab.com:michael.schmid1/test.git","http_url":"https://gitlab.com/michael.schmid1/test.git"},"target":{"id":5796982,"name":"test","description":"","web_url":"https://gitlab.com/michael.schmid1/test","avatar_url":null,"git_ssh_url":"git@gitlab.com:michael.schmid1/test.git","git_http_url":"https://gitlab.com/michael.schmid1/test.git","namespace":"michael.schmid1","visibility_level":0,"path_with_namespace":"michael.schmid1/test","default_branch":"master","ci_config_path":null,"homepage":"https://gitlab.com/michael.schmid1/test","url":"git@gitlab.com:michael.schmid1/test.git","ssh_url":"git@gitlab.com:michael.schmid1/test.git","http_url":"https://gitlab.com/michael.schmid1/test.git"},"last_commit":{"id":"{{ git_pr_commit_hash }}","message":"edit test2","timestamp":"2018-03-19T00:06:27+00:00","url":"https://gitlab.com/michael.schmid1/test/commit/3f116b9ce232c1c84ddac414abb73e985b67aee2","author":{"name":"Michael Schmid","email":"michael.schmid@amazee.com"}},"work_in_progress":false,"total_time_spent":0,"human_total_time_spent":null,"human_time_estimate":null,"action":"merge"},"labels":[],"changes":{"state":{"previous":"opened","current":"closed"},"updated_at":{"previous":"2018-03-19 00:06:28 UTC","current":"2018-03-19 00:07:53 UTC"},"total_time_spent":{"previous":null,"current":0}},"repository":{"name":"test","url":"git@gitlab.com:michael.schmid1/test.git","description":"","homepage":"https://gitlab.com/michael.schmid1/test"}}'
